---
output:
  pdf_document:
    toc: true
    toc_depth: 2
    number_sections: true
    includes:
      before_body: title.tex
      in_header: header.tex
---
```{r setup, include = FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(cache = TRUE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(error = FALSE)

BOSS_MODE <- TRUE
source('functions.R', local = knitr::knit_global())
scripts <- c("functions.R", "results1.R", "results2.R")
invisible(lapply(scripts, knitr::read_chunk))

packages <- c("deSolve", "ggplot2", "formatR", "scales", "ggpubr")
invisible(lapply(packages, library, character.only = T))
```

[//]: # (Page 4: Table of Contents)

\newpage

[//]: # (Page 5: Introduction)
\pagenumbering{arabic}
# Introduction
## Purpose
The effects of climate change are an existential threat to the planet earth.
This paper's purpose is to reproduce and expand on the research done by E Duque-Marin to get a further understanding of the dynamics and different scenarios of fruit tree growth, and by extension shed light on a part of this humongous problem that is already cropping up around the world.

## Theory
For use in the simulations, two differential equations were obtained from *E Duque-Marín et al 2022 J. Phys.: Conf. Ser. 2153 012018*. Their accompanying parameters are listed below.

| **Parameter** | **Meaning**                       |
|---------------|-----------------------------------|
| $q$           | Accumulated energy constant       |
| $r$           | Fruit trees intrinsic growth rate |
| $N$           | Fruit carrying capacity           |
| $I$           | Irrigation water amount           |
| $\beta$       | Evapotranspiration rate           |
| $\gamma$      | Photosynthetic contribution rate  |
| $\omega$      | Mortality rate of fruit trees     |

$$Equations:$$
$$ W'(t) = -\beta qW(t) - rC(t)(1 - \frac{C(t)}{N} W(t) $$
$$ C'(t) = rC(t)(1 - \frac{C(t)}{N})W(t) + \frac{\gamma qC(t)W(t)}{(C+1)(W+1)}-\omega C(1) \qquad t \ne nT $$
$$ \Delta W(nT) = I $$
$$ \Delta C(nT) = 0 \qquad t = nT $$

These equations come forth from a plethora of different papers, all of these are listed in *E Duque-Marín et al 2021 J. Phys.: Conf. Ser. 2046 012017*, the paper which proves these equations.

\newpage

[//]: # (Page : Materials & methods)
# Materials and Methods
Since no datasets were used in the production of the results, the simulation data had to be generated.
This data was plotted using R graphics.

## Materials
The simulation data was obtained using the ODE (ordinary differential equation) function of deSolve.
This function takes differential equations and parameters and calculates the output of these functions.
Aforementioned equations and parameters can ben found in the theory section.
Other packages like ggplot2, ggpubr, formatR and scales were used in data visualisation.

| **Software** | **Package** | **Version** |
|--------------|-------------|-------------|
| R            |             | 4.0.4       |
|              | deSolve     | 1.32        |
|              | formatR     | 1.11.1      |
|              | ggplot2     | 3.3.5       |
|              | ggpubr      | 0.4.0       |
|              | scales      | 1.1.1       |

The simulation data consists of an index, the $time$, water level in the soil ($W$) and biomass ($C$).

|     | **$time$** | **$W$**  | **$C$** |
|-----|------------|----------|---------|
| 1   | 0.00000    | 0.600000 | 1.00000 |
| 2   | 1.00000    | 0.556209 | 1.02602 |
| 3   | 2.00000    | 0.514991 | 1.05076 |
| 4   | 3.00000    | 0.476281 | 1.07421 |
| 5   | 4.00000    | 0.440001 | 1.09637 |

## Methods
The differential equations were translated into a mathematical model that deSolve could understand.
The last two equations also needed to be incorporated, this was done through if/else statements. After which several tests were run to ensure parity with the described model in the paper. File: [results1](results1.R).

After this, the model was updated to use 1h steps instead of 1 day.
This lead to the model being adapted to incorporate different growth rates for day and night, for even more precise date. File: [results2](results2.R).

Another few models were made to compare different irrigation intervals, as well as a model to water the soil as soon as almost all water was drained from it. Files: [results3](results3.R) \& [results4](results4.R).



\newpage

[//]: # (Page : Results)
# Results
```{r res1, file = 'results1.R'}
```
```{r res2, file = 'results2.R'}
```
```{r res3, file = 'results3.R'}
```
```{r res4, file = 'results4.R'}
```


\newpage

[//]: # (Page : Conclusion)
# Conclusion


\newpage

[//]: # (Page : Discussion)
# Discussion


\newpage

[//]: # (Page : References)
# References
```{r references, child = 'references.rmd'}
```

\newpage

[//]: # (Page : Appendix)
# Appendix
```{r appendix, child = 'appendix.rmd'}
```
